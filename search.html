<html>
  <head>
  	<title> Search Result </title>
  	<style>
table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
    width: 100%;
}

td, th {
    border: 1px solid #dddddd;
    text-align: left;
    padding: 8px;
}

tr:nth-child(even) {
    background-color: #dddddd;
}
</style>
  </head>
  <body>
  	<h3 align="center"> Search Output </h3>
  	<input type="text" id="staticTextId" name="staticTextName" value="No Result Found" disabled>
  	<div id="tablePrint"> </div>

  	<script type="text/javascript">
		var GET = {};
        var queryString = window.location.search.replace(/^\?/, '');
        queryString.split(/\&/).forEach(function(keyValuePair) {
        	var paramName = keyValuePair.replace(/=.*$/, ""); // some decoding is probably necessary
        	var paramValue = keyValuePair.replace(/^[^=]*\=/, ""); // some decoding is probably necessary
        	GET[paramName] = paramValue;
       	});
       	response = callElasticSearch(GET['q'], GET['category'])

       	if(response.hits.total > 0) {
       		document.getElementById('staticTextId').hidden = true;
        	var hitsResult = response.hits.hits;

			var myTable= "<table><th>Index</th><th>Title</th><th>Content</th>";
        	for(var i = 0; i < hitsResult.length; i++) {
        		myTable+="<tr><td>" + (i+1) + "</td>";
    			myTable+="<td>" + hitsResult[i]['_source'].title + "</td>";
    			myTable+="<td>" + hitsResult[i]['_source'].content + "</td></tr>";
        	}
        	myTable+="</table>";
        	document.write( myTable);
        }

       	function callElasticSearch(query, index) {
       		if(index == 'all') {
       			index = '';
       		}

        	var xmlHttp = new XMLHttpRequest();
        	// Apple reviews
        	xmlHttp.open( "GET", "https://search-play-review-s2euwwqqevpg7z3ivnrnunodvq.us-west-2.es.amazonaws.com/" + index + "/_search?q=" + query, false);
        	xmlHttp.send(null);

        	return JSON.parse(xmlHttp.responseText);
      	} 
  	</script>
  </body>	
</html>  	